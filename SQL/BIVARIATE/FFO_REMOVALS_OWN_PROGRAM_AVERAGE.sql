SELECT EVAL_GRP, EVAL_GRP_DESCR,237 ATTRIBUTE_NBR,'AVERAGE ANNUAL HARVEST REMOVALS OF SOUND BOLE VOLUME OF TREES (AT LEAST 5 INCHES D.B.H./D.R.C.), IN CUBIC FEET, ON FOREST LAND' ATTRIBUTE_DESCR,  COALESCE(CAST(GRP_BY_ATTRIB AS VARCHAR(4000)), 'NOT AVAILABLE') GROUP_BY_FIELD, SUM(ESTIMATE_BY_ESTN_UNIT.ESTIMATE) ESTIMATE, CASE WHEN SUM(ESTIMATE_BY_ESTN_UNIT.ESTIMATE) <> 0 THEN ABS(SQRT(SUM(ESTIMATE_BY_ESTN_UNIT.VAR_OF_ESTIMATE)) / SUM(ESTIMATE_BY_ESTN_UNIT.ESTIMATE) * 100) ELSE 0 END AS SE_OF_ESTIMATE_PCT, SQRT(SUM(ESTIMATE_BY_ESTN_UNIT.VAR_OF_ESTIMATE)) SE_OF_ESTIMATE, SUM(ESTIMATE_BY_ESTN_UNIT.VAR_OF_ESTIMATE) VAR_OF_ESTIMATE, SUM(ESTIMATE_BY_ESTN_UNIT.TOTAL_PLOTS) TOTAL_PLOTS, SUM(ESTIMATE_BY_ESTN_UNIT.NON_ZERO_PLOTS) NON_ZERO_PLOTS, SUM(ESTIMATE_BY_ESTN_UNIT.TOT_POP_AREA_ACRES) TOT_POP_AC, 'AND COND.OWNCD = 45 AND PCOND.OWNCD = 45' FILTER, 'NWOS' JOINS FROM (SELECT POP_EVAL_GRP_CN, EVAL_GRP, EVAL_GRP_DESCR, SUM(COALESCE(YSUM_HD, 0) * PHASE_1_SUMMARY.EXPNS) ESTIMATE, PHASE_1_SUMMARY.N TOTAL_PLOTS, SUM(PHASE_SUMMARY.NUMBER_PLOTS_IN_DOMAIN) DOMAIN_PLOTS, SUM(PHASE_SUMMARY.NON_ZERO_PLOTS) NON_ZERO_PLOTS, TOTAL_AREA * TOTAL_AREA / PHASE_1_SUMMARY.N * ((SUM(W_H * PHASE_1_SUMMARY.N_H * (((COALESCE(YSUM_HD_SQR, 0) / PHASE_1_SUMMARY.N_H) - ((COALESCE(YSUM_HD, 0) / PHASE_1_SUMMARY.N_H) * (COALESCE(YSUM_HD, 0) / PHASE_1_SUMMARY.N_H))) / (PHASE_1_SUMMARY.N_H - 1)))) + 1 / PHASE_1_SUMMARY.N * (SUM((1 - W_H) * PHASE_1_SUMMARY.N_H * (((COALESCE(YSUM_HD_SQR, 0) / PHASE_1_SUMMARY.N_H) - ((COALESCE(YSUM_HD, 0) / PHASE_1_SUMMARY.N_H) * (COALESCE(YSUM_HD, 0) / PHASE_1_SUMMARY.N_H))) / (PHASE_1_SUMMARY.N_H - 1))))) VAR_OF_ESTIMATE, TOTAL_AREA TOT_POP_AREA_ACRES, GRP_BY_ATTRIB FROM (SELECT PEV.CN EVAL_CN, PEG.EVAL_GRP, PEG.EVAL_GRP_DESCR, PEG.CN POP_EVAL_GRP_CN, POP_STRATUM.ESTN_UNIT_CN, POP_STRATUM.EXPNS, POP_STRATUM.CN POP_STRATUM_CN, P1POINTCNT / (SELECT SUM(STR.P1POINTCNT) FROM FS_FIADB.POP_STRATUM STR WHERE STR.ESTN_UNIT_CN = POP_STRATUM.ESTN_UNIT_CN) W_H, (SELECT SUM(STR.P1POINTCNT) FROM FS_FIADB.POP_STRATUM STR WHERE STR.ESTN_UNIT_CN = POP_STRATUM.ESTN_UNIT_CN) N_PRIME, P1POINTCNT N_PRIME_H, (SELECT SUM(EU_S.AREA_USED) FROM FS_FIADB.POP_ESTN_UNIT EU_S WHERE EU_S.CN = POP_STRATUM.ESTN_UNIT_CN) TOTAL_AREA, (SELECT SUM(STR.P2POINTCNT) FROM FS_FIADB.POP_STRATUM STR WHERE STR.ESTN_UNIT_CN = POP_STRATUM.ESTN_UNIT_CN) N, POP_STRATUM.P2POINTCNT N_H FROM FS_FIADB.POP_EVAL_GRP PEG JOIN FS_FIADB.POP_EVAL_TYP PET ON (PET.EVAL_GRP_CN = PEG.CN) JOIN FS_FIADB.POP_EVAL PEV ON (PEV.CN = PET.EVAL_CN) JOIN FS_FIADB.POP_ESTN_UNIT PEU ON (PEV.CN = PEU.EVAL_CN) JOIN FS_FIADB.POP_STRATUM POP_STRATUM ON (PEU.CN = POP_STRATUM.ESTN_UNIT_CN) WHERE PEG.EVAL_GRP IN (12018, 42018, 52018, 62018, 82018, 92018, 102018, 122018, 132018, 172018, 182018, 192018, 202018, 212018, 222018, 232018, 242018, 252018, 262018, 272018, 282018, 292018, 302018, 312018, 332018, 342018, 362018, 372018, 382018, 392018, 402018, 412018, 422018, 442018, 452018, 462018, 472018, 482018, 492018, 502018, 512018, 532018, 542018, 552018) AND PET.EVAL_TYP = 'EXPREMV') PHASE_1_SUMMARY LEFT OUTER JOIN (SELECT POP_STRATUM_CN,ESTN_UNIT_CN,EVAL_CN, SUM(Y_HID_ADJUSTED) YSUM_HD, SUM(Y_HID_ADJUSTED * Y_HID_ADJUSTED) YSUM_HD_SQR, COUNT(*) NUMBER_PLOTS_IN_DOMAIN, SUM(CASE WHEN Y_HID_ADJUSTED IS NULL THEN 0 WHEN Y_HID_ADJUSTED = 0 THEN 0 ELSE 1 END) NON_ZERO_PLOTS, GRP_BY_ATTRIB FROM (SELECT   SUM((GRM.TPAREMV_UNADJ * (CASE              WHEN COALESCE(GRM.SUBPTYP_GRM, 0) = 0 THEN               (0)              WHEN GRM.SUBPTYP_GRM = 1 THEN               POP_STRATUM.ADJ_FACTOR_SUBP              WHEN GRM.SUBPTYP_GRM = 2 THEN               POP_STRATUM.ADJ_FACTOR_MICR              WHEN GRM.SUBPTYP_GRM = 3 THEN               POP_STRATUM.ADJ_FACTOR_MACR              ELSE               (0)            END) * (CASE              WHEN GRM.COMPONENT LIKE 'CUT%' THEN               TRE_MIDPT.VOLCFSND              ELSE               (0)            END))  ) AS Y_HID_ADJUSTED, PEU.CN ESTN_UNIT_CN, PEV.CN EVAL_CN, POP_STRATUM.CN POP_STRATUM_CN, PLOT.CN PLT_CN, NWOS.RESPONSE_VALUE GRP_BY_ATTRIB   FROM  FS_FIADB.POP_EVAL_GRP PEG JOIN FS_FIADB.POP_EVAL_TYP PET ON (PET.EVAL_GRP_CN = PEG.CN) JOIN FS_FIADB.POP_EVAL PEV ON (PEV.CN = PET.EVAL_CN) JOIN FS_FIADB.POP_ESTN_UNIT PEU ON (PEV.CN = PEU.EVAL_CN) JOIN FS_FIADB.POP_STRATUM POP_STRATUM ON (PEU.CN = POP_STRATUM.ESTN_UNIT_CN)         JOIN FS_FIADB.POP_PLOT_STRATUM_ASSGN POP_PLOT_STRATUM_ASSGN ON (POP_STRATUM.CN = POP_PLOT_STRATUM_ASSGN.STRATUM_CN)        JOIN FS_FIADB.PLOT PLOT ON (POP_PLOT_STRATUM_ASSGN.PLT_CN = PLOT.CN)        JOIN FS_FIADB.PLOTGEOM PLOTGEOM ON (PLOT.CN = PLOTGEOM.CN)        JOIN FS_FIADB.PLOT    PPLOT ON (PLOT.PREV_PLT_CN = PPLOT.CN)        JOIN FS_FIADB.SDS_COND_VW    PCOND   ON (PLOT.PREV_PLT_CN = PCOND.PLT_CN)        JOIN FS_FIADB.SDS_COND_VW    COND   ON (PLOT.CN = COND.PLT_CN)         JOIN FS_FIADB.TREE TREE  ON (TREE.CONDID = COND.CONDID                                    AND TREE.PLT_CN = PLOT.CN AND TREE.PREVCOND = PCOND.CONDID)    LEFT OUTER JOIN FS_FIADB.TREE PTREE     ON (TREE.PREV_TRE_CN = PTREE.CN)   LEFT OUTER JOIN FS_FIADB.TREE_GRM_BEGIN TRE_BEGIN     ON (TREE.CN = TRE_BEGIN.TRE_CN)   LEFT OUTER JOIN FS_FIADB.TREE_GRM_MIDPT TRE_MIDPT     ON (TREE.CN = TRE_MIDPT.TRE_CN)   LEFT OUTER JOIN               (SELECT TRE_CN,                DIA_BEGIN,                DIA_MIDPT,                DIA_END,                SUBP_COMPONENT_AL_FOREST     AS COMPONENT,                SUBP_SUBPTYP_GRM_AL_FOREST   AS SUBPTYP_GRM,                SUBP_TPAREMV_UNADJ_AL_FOREST AS TPAREMV_UNADJ           FROM FS_FIADB.TREE_GRM_COMPONENT) GRM     ON (TREE.CN = GRM.TRE_CN) LEFT OUTER JOIN (SELECT NWOS_CERT.PLT_CN, CERT, COST, TAX, CASE WHEN CERT = 1 OR COST = 1 OR TAX = 1 THEN 1 WHEN CERT IN (0, 9) OR COST IN (0, 9) OR TAX IN (0, 9) THEN 0 ELSE -1 END AS RESPONSE_VALUE FROM (SELECT PLT_CN, RESPONSE_VALUE CERT FROM FS_NWOS.PLOT_OWNER PO, FS_NWOS.OWNER      O, FS_NWOS.SAMPLE     S, FS_NWOS.RESPONSE   R, FS_NWOS.QUEST      Q WHERE PO.OWNER_CN = O.CN AND S.OWNER_CN = O.CN AND R.SAMPLE_CN = S.CN AND Q.RESPONSE_CN = R.CN AND S.NWOS_STUDY = 'base' AND PO.ORIGIN = 'P2' AND O.OWNCD_NWOS = 45 AND R.RESPONSE_CD = 1 AND Q.RESPONSE_VALUE <> -1 AND Q.METADATA_CN = 'QMD114' GROUP BY PLT_CN, RESPONSE_VALUE) NWOS_CERT JOIN (SELECT PLT_CN, RESPONSE_VALUE COST FROM FS_NWOS.PLOT_OWNER PO, FS_NWOS.OWNER      O, FS_NWOS.SAMPLE     S, FS_NWOS.RESPONSE   R, FS_NWOS.QUEST      Q WHERE PO.OWNER_CN = O.CN AND S.OWNER_CN = O.CN AND R.SAMPLE_CN = S.CN AND Q.RESPONSE_CN = R.CN AND S.NWOS_STUDY = 'base' AND PO.ORIGIN = 'P2' AND O.OWNCD_NWOS = 45 AND R.RESPONSE_CD = 1 AND Q.RESPONSE_VALUE <> -1 AND Q.METADATA_CN = 'QMD121' GROUP BY PLT_CN, RESPONSE_VALUE) NWOS_COST ON (NWOS_CERT.PLT_CN = NWOS_COST.PLT_CN) JOIN (SELECT PLT_CN, RESPONSE_VALUE TAX FROM FS_NWOS.PLOT_OWNER PO, FS_NWOS.OWNER      O, FS_NWOS.SAMPLE     S, FS_NWOS.RESPONSE   R, FS_NWOS.QUEST      Q WHERE PO.OWNER_CN = O.CN AND S.OWNER_CN = O.CN AND R.SAMPLE_CN = S.CN AND Q.RESPONSE_CN = R.CN AND S.NWOS_STUDY = 'base' AND PO.ORIGIN = 'P2' AND O.OWNCD_NWOS = 45 AND R.RESPONSE_CD = 1 AND Q.RESPONSE_VALUE <> -1 AND Q.METADATA_CN = 'QMD116' GROUP BY PLT_CN, RESPONSE_VALUE) NWOS_TAX ON (NWOS_CERT.PLT_CN = NWOS_TAX.PLT_CN)) NWOS ON (NWOS.PLT_CN = PLOT.CN) WHERE  1=1 AND  PET.EVAL_TYP = 'EXPREMV' AND PEG.EVAL_GRP IN (12018, 42018, 52018, 62018, 82018, 92018, 102018, 122018, 132018, 172018, 182018, 192018, 202018, 212018, 222018, 232018, 242018, 252018, 262018, 272018, 282018, 292018, 302018, 312018, 332018, 342018, 362018, 372018, 382018, 392018, 402018, 412018, 422018, 442018, 452018, 462018, 472018, 482018, 492018, 502018, 512018, 532018, 542018, 552018)  AND  1=1  AND COND.OWNCD = 45 AND PCOND.OWNCD = 45 GROUP BY PEU.CN, PEV.CN, POP_STRATUM.CN, PLOT.CN, NWOS.RESPONSE_VALUE) PLOT_SUMMARY GROUP BY POP_STRATUM_CN, ESTN_UNIT_CN, EVAL_CN, GRP_BY_ATTRIB) PHASE_SUMMARY ON (PHASE_1_SUMMARY.POP_STRATUM_CN = PHASE_SUMMARY.POP_STRATUM_CN AND PHASE_1_SUMMARY.EVAL_CN = PHASE_SUMMARY.EVAL_CN AND PHASE_1_SUMMARY.ESTN_UNIT_CN = PHASE_SUMMARY.ESTN_UNIT_CN) GROUP BY PHASE_1_SUMMARY.POP_EVAL_GRP_CN, PHASE_1_SUMMARY.EVAL_GRP, PHASE_1_SUMMARY.EVAL_GRP_DESCR, PHASE_1_SUMMARY.ESTN_UNIT_CN, PHASE_1_SUMMARY.TOTAL_AREA, PHASE_1_SUMMARY.N, GRP_BY_ATTRIB) ESTIMATE_BY_ESTN_UNIT WHERE NON_ZERO_PLOTS IS NOT NULL GROUP BY POP_EVAL_GRP_CN, EVAL_GRP, EVAL_GRP_DESCR, COALESCE(CAST(GRP_BY_ATTRIB AS VARCHAR(4000)), 'NOT AVAILABLE')